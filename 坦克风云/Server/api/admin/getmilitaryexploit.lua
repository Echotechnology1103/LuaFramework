
--获取军功排行榜x
function api_admin_getmilitaryexploit(request)
    local response = {
        ret=-1,
        msg='error',
        data = {},
    }
    local num = tonumber(request.params.num) or 0
    local cuuturt =getWeeTs()+10800

    local ts  = getClientTs()

    if ts< cuuturt then

        cuuturt=cuuturt-24*3600
    end
    local dayrankkey = "z"..getZoneId()..".dayUserNewRank.All.100"..cuuturt
    local redis = getRedis()
    local ret=redis:get(dayrankkey)
    ret =json.decode(ret)
    local list = {}
    if type(ret) == 'table' then
        for _,v in pairs(ret) do
            local uid = tonumber(v["uid"]) or 0
            if uid>0 then
                local uobjs = getUserObjs(uid,true)
                local userinfo = uobjs.getModel('userinfo')
                local score = v.score
                local item = {}

                table.insert(item,userinfo.uid)
                table.insert(item,userinfo.nickname)                
                table.insert(item,score)
                table.insert(item,userinfo.fc)
                table.insert(item,userinfo.level)
                table.insert(item,userinfo.vip)
                
                table.insert(list,item)
            end   

        end

    end

    response.ret = 0
    response.msg = 'Success'
    response.data.fightlist = list

    return response

end



