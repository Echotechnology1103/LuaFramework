---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2018/10/11 14:40
---
AdvanceStarItem = AdvanceStarItem or class("AdvanceStarItem", Node)
local this = AdvanceStarItem

AdvanceStarItem.robotSetValue = false;

function AdvanceStarItem:ctor(obj, tab)
    self.transform = obj.transform
    self.gameObject = self.transform.gameObject;
    self.data = tab;
    self.image_ab = "dungeon_image";
    self.transform_find = self.transform.Find;
    self.events = {};
    self:Init();
    --self:AddEvents();
end

function AdvanceStarItem:dctor()
    GlobalEvent:RemoveTabListener(self.events);
    if self.schedule then
        GlobalSchedule:Stop(self.schedule);
    end
    if self.awardItem then
        self.awardItem:destroy();
    end
    self.awardItem = nil;
    self:CloseEffect();
    self:CloseReddot();
end

function AdvanceStarItem:Init()
    self.is_loaded = true;
    self.nodes = {
        "star", "icon", "num", "yilingqu",
    }
    self:GetChildren(self.nodes);

    self:InitUI();
    --self:AddEvents();
end

function AdvanceStarItem:InitUI()
    self.num = GetText(self.num);
    self.star = GetImage(self.star);
    self.yilingqu = GetImage(self.yilingqu);

    SetGameObjectActive(self.yilingqu, false);
    --data = {star = 3, reward = [[{14008,1,1}]]}
    if self.data then
        local reward = String2Table(self.data.reward);
        if reward then
            self.awardItem = AwardItem(self.icon);
            self.awardItem:SetData(reward[1], reward[2]);
            self.num.text = tostring(self.data.star);
            --
        end


    end
end

function AdvanceStarItem:AddEvents()
    self.awardItem:AddClickTips();
end

--设置是否选中当前物体
function AdvanceStarItem:SetSelected(bool)
    bool = bool and true or false;
    self.selected.gameObject:SetActive(bool);
end
function AdvanceStarItem:SetText(num)
    if self.num and self.data then
        self.num.text = tostring(num .. "/" .. self.data.star);
    end
end
--31E91D
function AdvanceStarItem:SetText2(str)
    if self.num then
        self.num.text = str;
    end
end

function AdvanceStarItem:SetGray()
    if self.awardItem then
        self.awardItem:SetIconGray(true);
        SetGameObjectActive(self.yilingqu, true);
    end
end

function AdvanceStarItem:ShowEffect()
    self:CloseEffect();
    self.effect = UIEffect(self.transform , 10307 , false);
    self.effect:SetConfig({ scale = 0.8 , pos = { x = 0, y = 9.3, z = 0 } })


    self:CloseReddot();
    self.reddot = RedDot(self.transform, nil, RedDot.RedDotType.Nor)
    self.reddot:SetPosition(26, 34);
    self.reddot:SetRedDotParam(true);
end

function AdvanceStarItem:CloseEffect()
    if self.effect then
        self.effect:destroy();
    end
    self.effect = nil;
end

function AdvanceStarItem:CloseReddot()
    if self.reddot then
        self.reddot:destroy();
    end
    self.reddot = nil;
end