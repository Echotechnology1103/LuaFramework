---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 18/11/23 19:38
---
DungeonExpelPanel = DungeonExpelPanel or class("DungeonExpelPanel", BasePanel)
local this = DungeonExpelPanel

function DungeonExpelPanel:ctor()
    self.abName = "dungeon"
    self.assetName = "DungeonExpelPanel"
    self.layer = "UI"

    self.use_background = true;
    self.change_scene_close = false;
    self.is_singleton = true;
end

function DungeonExpelPanel:dctor()
    if self.countdownitem then
        self.countdownitem:destroy();
    end
    self.countdownitem = nil;
end

function DungeonExpelPanel:Open(data)
    self.data = data
    DungeonExpelPanel.super.Open(self)
end

function DungeonExpelPanel:LoadCallBack()
    self.nodes = {
        "enter_btn", "enter_btn/Text", "content",
    }
    self:GetChildren(self.nodes)
    self:InitUI();
    self:AddEvent()
end
local ConfigLanguage = require('game.config.language.CnLanguage')
function DungeonExpelPanel:InitUI()
    self.content = GetText(self.content);

    if (self.customText) then
        self.content.text = self.customText
        self.customText = nil
    else
        self.content.text = ConfigLanguage.Dungeon.DUNGEON_EXPEL_TIP;
    end

    self.countdownitem = CountDownText(self.enter_btn.transform, { isShowMin = false, duration = 0.2, nodes = { "Text" }, formatTime = "%d", formatText = "Confirm (%s)" })
    self.countdownitem:StartSechudle(10 + os.time(), handler(self, self.HandleCountDown))
end

function DungeonExpelPanel:AddEvent()
    AddClickEvent(self.enter_btn.gameObject, handler(self, self.HandleExit))
end

function DungeonExpelPanel:SetText(text)
    if self.is_Loaded then
        self.content.text = text
    else
        self.customText = text
    end
end

function DungeonExpelPanel:HandleExit(target, x, y)
    SceneControler:GetInstance():RequestSceneLeave();
    self:Close();
end

function DungeonExpelPanel:HandleCountDown()
    self:Close();
end