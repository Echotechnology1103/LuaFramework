---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by R2D2.
--- DateTime: 2019/2/23 9:43
---
FactionBattleTempleTitleView = {}

function FactionBattleTempleTitleView:SetParent(parent)
    self.parent =  parent
end

function FactionBattleTempleTitleView:dctor()
    self.parent = nil
    self.TitleList = nil
end

function FactionBattleTempleTitleView:AddUI(...)
    self.TitleList = self.TitleList or {}

    local tab

    for i, v in ipairs({ ... }) do
        tab = {}
        tab.parent = v
        tab.careerImg = GetImage(GetChild(v, "Image"))
        tab.titleText = GetText(GetChild(v, "JobTitle"))
        tab.titleOutline = GetChild(v, "JobTitle"):GetComponent('Outline')
        tab.nameText = GetText(GetChild(v, "RoleName"))

        self.TitleList[i] = tab
    end
end

function FactionBattleTempleTitleView:SetData(index, role)
    if (self.TitleList and self.TitleList[index]) then
        local view = self.TitleList[index]

        if (role)  then

            if(role.figure.jobtitle and role.figure.jobtitle.model > 0) then
                local titleCfg  = Config.db_jobtitle[role.figure.jobtitle.model]
                local r, g, b, a = HtmlColorStringToColor(titleCfg.color)
                view.titleText.text =  titleCfg.name
                SetOutLineColor(view.titleOutline, r, g, b, a)
            else
                view.titleText.text = ""
            end

            lua_resMgr:SetImageTexture(self.parent, view.careerImg, "faction_image",
                    "faction_career_" .. role.gpost)
            view.careerImg.enabled = true
            view.nameText.text =  role.name
            self:Resize(view)
        else
            view.careerImg.enabled = false
            view.titleText.text = ""
            view.nameText.text = ""
        end
    end
end


function FactionBattleTempleTitleView:Resize(view)

    SetSizeDeltaX(view.titleText.transform, view.titleText.preferredWidth)
    SetSizeDeltaX(view.nameText.transform, view.nameText.preferredWidth)

    local fullW = view.nameText.preferredWidth + view.titleText.preferredWidth
    SetSizeDeltaX(view.parent, fullW)
    local firstX = (view.titleText.preferredWidth - fullW) / 2

    SetLocalPositionX(view.titleText.transform, firstX)
    SetLocalPositionX(view.nameText.transform, firstX + fullW / 2)
end



return FactionBattleTempleTitleView