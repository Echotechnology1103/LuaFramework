---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Admin.
--- DateTime: 2019/12/24 14:51

ChildActRankIten = ChildActRankIten or class("ChildActRankIten", BaseCloneItem)
local ChildActRankIten = ChildActRankIten

function ChildActRankIten:ctor(parent_node, layer)
    ChildActRankIten.super.Load(self)
end

function ChildActRankIten:dctor()
end

function ChildActRankIten:LoadCallBack()
    self.nodes = {
     "name","power","bg/one","bg/two","bg/thr","bg/other","rank"
    }
    self:GetChildren(self.nodes)
	self.nameTex = GetText(self.name) 
	self.powerTex = GetText(self.power)
	self.rankTex = GetText(self.rank)
  
	self:AddEvent()
end

function ChildActRankIten:AddEvent()
end



function ChildActRankIten:SetData(data,actID,type,index, show)
	self.data = data 
	self.actID = actID
	self.show = show
	if type == 2 then
		self.rankId = self.actID
	else
		self.rankId = OperateModel:GetInstance():GetConfig(self.actID).rank
	end
	self.cfgData = RankModel:GetInstance():GetRankById(self.rankId)

	if data == nil then
		self.nameTex.text = "Nobody has made the list yet"
		--self.rankTex.text =  index
		--   SetVisible(self.power,false)
		
		local limen = self.cfgData.limen
		--E77E5B
		local des = ""
		if self.rankId == 130101 then --宠物
			des = string.format("<color=#E77E5B>Require: %s CP</color>",GetShowNumber(limen))
		end
		self.powerTex.text = des
		self:SetBG(index)
		return
	end
	

	-- dump(self.data)
	self:UpdateInfo()
	self:SetBG(data.rank)
end

function ChildActRankIten:UpdateInfo()
	local str
	if self.show then
		str = RoleInfoModel:GetInstance():GetServerName(self.data.base.suid) .."·" .. self.data.base.name
	else
		str = self.data.base.name
	end
	self.nameTex.text = str
	self.powerTex.text = self.data.sort
end

function ChildActRankIten:SetBG(index)
	if index <= 3 then
		self.rankTex.text = ""
		SetVisible(self.one, index == 1)
		SetVisible(self.two, index == 2)
		SetVisible(self.thr, index == 3)
	else
		self.rankTex.text = index
		SetVisible(self.other, true)
	end
end

