---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2019/3/16/016 15:45
---
require("game/tips/HorseRaceTip");

TipsManager = TipsManager or class("TipsManager")
local this = TipsManager

TipsManager.wait_show_tips = {};
TipsManager.showingTips = {};
--
--
--msg 要显示的消息   show_type 显示的类型,缩放/Fadeto
function TipsManager.ShowHorseRaceTip(msg, show_type)
    msg = msg.gsub(msg , "<a([^<>]*)>" , "");
    msg = msg.gsub(msg , "</a>" , "");
    local msgtab = {
        msg = msg,
        show_type = show_type,
    }
    table.insert(TipsManager.wait_show_tips, msgtab);

    if not TipsManager.schedule then
        TipsManager.schedule = GlobalSchedule.StartFun(TipsManager.ShowTip, 0.7, -1)
        TipsManager.ShowTip();
    end
end

function TipsManager.ShowTip()
    if #TipsManager.showingTips == 1 and #TipsManager.wait_show_tips == 0 then
    elseif #TipsManager.showingTips > 0 then
        local tip1 = TipsManager.showingTips[1];
        table.remove(TipsManager.showingTips, 1);
        tip1:destroy();
    end
    if #TipsManager.wait_show_tips > 0 then
        local msgtab = TipsManager.wait_show_tips[1];
        table.remove(TipsManager.wait_show_tips, 1);

        local tip = HorseRaceTip(LayerManager:GetInstance():GetLayerByName(LayerManager.LayerNameList.Top), msgtab);
        table.insert(TipsManager.showingTips, tip);
    else
        GlobalSchedule.StopFun(TipsManager.schedule);
        TipsManager.schedule = nil;
        --destroyTab(TipsManager.showingTips)
        --TipsManager.showingTips = {};
    end
end
function TipsManager.RemoveTip(tip)
    for i = 1, #TipsManager.showingTips do
        if TipsManager.showingTips[i] == tip then
            table.remove(TipsManager.showingTips, i);
        end
    end
end