---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by win 10.
--- DateTime: 2018/9/21 16:53
---
MountTogItem = MountTogItem or class("MountTogItem", Node)
local this = MountTogItem

function MountTogItem:ctor(_obj, mountID)
    self.mountID = mountID;
    self.transform = _obj.transform
    self.gameObject = self.transform.gameObject;
    self.transform_find = self.transform.Find;

    self:InitUI();
    self.events = {}

    self:AddEvent();
end

function MountTogItem:InitUI()
    self.is_loaded = true;
    self.nodes = {
        "mountName", "head", "riding", "frame", "selected", "mountjie", --"lock",
        "bg",
    }
    self:GetChildren(self.nodes)
    self.isOn = false;

    self.frame = GetImage(self.frame);
    self.selected = GetImage(self.selected);

    self.bg = GetImage(self.bg);

    self.riding = GetImage(self.riding);

    self.mountjie = GetText(self.mountjie);
    self.mountjie.text = "";
    self.mountName = GetText(self.mountName);
    --self.lock = GetImage(self.lock);
    self.head = GetImage(self.head);

    self.red_dot = RedDot(self.transform,nil,RedDot.RedDotType.Nor)
    self.red_dot:SetPosition(68,39)

    if self.is_udpate_reddot ~= nil then
        self:SetRedDotParam(self.is_udpate_reddot)
        self.is_udpate_reddot = nil
    end
    self:SetIsOn(self.isOn);

    self:SetBG();
end

function MountTogItem:AddEvent()
    --local call_back = function(target,bool)
    --    if self.tog.isOn then
    --        MountModel.GetInstance().currentMountID = self.mountID;
    --        GlobalEvent:Brocast(MountEvent.CHANGE_MOUNT , self.mountID);
    --        --GlobalEvent:Brocast(MountEvent.MOUNT_TO_CENTER , self.mountID);
    --
    --    end
    --end
    --AddValueChange(self.tog.gameObject , call_back)
end

function MountTogItem:SetIsOn(bool)
    self.isOn = toBool(bool);
    SetGameObjectActive(self.selected, self.isOn);
end

function MountTogItem:SetName(str)
    self.mountName.text = str;
end

function MountTogItem:SetJie(num)
    self.mountjie.text = "T" .. tostring(num);
end

function MountTogItem:SetIsLock(bool)
    --self.lock.gameObject:SetActive(bool);
    if bool then
        ShaderManager:GetInstance():SetImageGray(self.head);
    else
        ShaderManager:GetInstance():SetImageNormal(self.head);
    end
end

function MountTogItem:SetBG(res)
    res = res or "di_4";
    lua_resMgr:SetImageTexture(self, self.bg, "iconasset/icon_mount", tostring(res))
end

function MountTogItem:SetHead(res , abname)
    abname = abname or "iconasset/icon_mount";
    lua_resMgr:SetImageTexture(self, self.head, abname, tostring(res))
end

function MountTogItem:SetIsSelected(bool)
    --print2("MountTogItem:SetIsSelected need override");
    --if bool then
    --    GlobalEvent:Brocast(MountEvent.CHANGE_MOUNT , self.mountID);
    --    self.tog.isOn = true;
    MountModel:GetInstance().currentMountID = self.mountID;
    --end
end

function MountTogItem:SetRiding(flag)
    SetVisible(self.riding, flag)
    --if bool then
    --    lua_resMgr:SetImageTexture(self, self.riding, "mount_image", "mount_is_equip" , false);
    --else
    --    lua_resMgr:SetImageTexture(self, self.riding, "mount_image", "mount_is_ride" , false);
    --end
end

function MountTogItem:dctor()
    GlobalEvent:RemoveTabListener(self.events);
    if self.red_dot then
        self.red_dot:destroy()
        self.red_dot = nil
    end
end

function MountTogItem:GetHeight()
    return 112
end

function MountTogItem:SetParam(param)
    self.param = param
end

function MountTogItem:SetRedDotParam(param)
    if param == nil then
        param = false
    end
    if self.is_loaded then
        self.red_dot:SetRedDotParam(param)
    else
        self.is_udpate_reddot = param
    end
end